<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../iron-image/iron-image.html">
<link rel="import" href="../../paper-styles/paper-styles.html">
<link rel="import" href="../../paper-input/paper-input.html">
<link rel="import" href="../../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../paper-listbox/paper-listbox.html">

<link rel="import" href="../carbon-route.html">

<link rel="import" href="youtube-lite.html">

<dom-module id="video-viewer">
  <template>
    <style>
      :host {
        @apply(--paper-font-common-base);
        --primary-color: var(--paper-red-500);
      }

      #controls {
        display: flex;
      }

      #state {
        margin-left: 16px;
      }
    </style>

    <!-- This carbon-route consumes the route which was provided by the tail of a carbon-route in
    the host of this element -->
    <carbon-route route="{{route}}" match="/:vid" data="{{data}}"></carbon-route>

    <!-- youtube-lite consumes the route queryParams and updates the url accordingly -->
    <youtube-lite
        id="player"
        video-id="{{data.vid}}"
        state="{{route.queryParams.state}}"
        current-time="{{route.queryParams.time}}"
        start-time="{{route.queryParams.time}}">
    </youtube-lite>

    <div id="controls">
      <paper-input
          id="time"
          on-focus="pause"
          label="Time"
          value="{{route.queryParams.time}}">
      </paper-input>
      <paper-dropdown-menu id="state" label="State">
        <paper-listbox
            class="dropdown-content"
            selected="{{route.queryParams.state}}"
            attr-for-selected="state">
          <paper-item state="playing">playing</paper-item>
          <paper-item state="paused">paused</paper-item>
        </paper-listbox>
      </paper-dropdown-menu>
    </div>
    <ul>
      <li>Route prefix: {{route.prefix}}</li>
      <li>Route path: {{route.path}}</li>
      <li>QueryParams</li>
      <ul>
        <li>State: {{route.queryParams.state}}</li>
        <li>Time: {{route.queryParams.time}}</li>
      </ul>
    </ul>
  </template>

  <script>
    Polymer({
      is: 'video-viewer',

      properties: {
        route: {
          type: Object,
          notify: true
        },

        data: {
          type: Object
        }
      },

      pause: function() {
        this.set('route.queryParams.state', 'paused');
      }
    });
  </script>
</dom-module>
